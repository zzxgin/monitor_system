import{_ as C,r as i,g as w,o as F,m as M,s as S,n as x,c as n,d as r,e as a,p as I,f as P,q as U,F as _,j as m,t as l,x as p}from"./index-CR4645Pn.js";const V={class:"monitor-data"},B={class:"page-header"},A={class:"card-header"},L={class:"header-actions"},N=["value"],j=["disabled"],q={class:"monitor-list"},z={key:0,class:"loading"},E={key:1,class:"empty"},G={key:2,class:"table-container"},H={class:"data-table"},J={__name:"MonitorData",setup(K){const d=i(!1),c=i([]),h=i([]),o=i("");w(()=>o.value?c.value.filter(s=>s.server_id===parseInt(o.value)):c.value),F(()=>{f(),u()}),M(o,()=>{u()});const f=async()=>{try{const s=await S.getServers();s.code===0&&(h.value=s.data||[])}catch(s){console.error("加载服务器列表失败:",s)}},u=async()=>{try{d.value=!0;const s=o.value?{server_id:parseInt(o.value)}:void 0,t=await x.getMonitorData(s);t.code===0?c.value=t.data||[]:alert("加载监控数据失败: "+(t.msg||""))}catch(s){console.error("加载监控数据失败:",s),alert("加载监控数据失败")}finally{d.value=!1}},b=()=>{u()},v=s=>s==null?"--":parseFloat(s).toFixed(1),g=s=>s?new Date(s).toLocaleString():"",y=s=>{const t=parseFloat(s);return t>=85?"critical":t>=70?"warning":"normal"},k=s=>{const t=parseFloat(s);return t>=90?"critical":t>=80?"warning":"normal"},D=s=>{const t=parseFloat(s);return t>=95?"critical":t>=85?"warning":"normal"};return(s,t)=>(r(),n("div",V,[a("div",B,[a("div",A,[t[2]||(t[2]=a("h2",null,"监控数据",-1)),a("div",L,[P(a("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),class:"server-select"},[t[1]||(t[1]=a("option",{value:""},"所有服务器",-1)),(r(!0),n(_,null,m(h.value,e=>(r(),n("option",{key:e.id,value:e.id},l(e.server_name)+" ("+l(e.ip_address)+") ",9,N))),128))],512),[[U,o.value]]),a("button",{class:"btn btn-primary",onClick:b,disabled:d.value},l(d.value?"刷新中...":"刷新"),9,j)])])]),a("div",q,[d.value?(r(),n("div",z,"加载中...")):c.value.length===0?(r(),n("div",E,"暂无监控数据")):(r(),n("div",G,[a("table",H,[t[3]||(t[3]=a("thead",null,[a("tr",null,[a("th",null,"服务器"),a("th",null,"IP地址"),a("th",null,"CPU使用率"),a("th",null,"内存使用率"),a("th",null,"磁盘使用率"),a("th",null,"记录时间")])],-1)),a("tbody",null,[(r(!0),n(_,null,m(c.value,e=>(r(),n("tr",{key:e.id},[a("td",null,l(e.server_name),1),a("td",null,l(e.ip_address),1),a("td",null,[a("span",{class:p(y(e.cpu_value))},l(v(e.cpu_value))+"% ",3)]),a("td",null,[a("span",{class:p(k(e.memory_value))},l(v(e.memory_value))+"% ",3)]),a("td",null,[a("span",{class:p(D(e.disk_value))},l(v(e.disk_value))+"% ",3)]),a("td",null,l(g(e.recorded_at)),1)]))),128))])])]))]),t[4]||(t[4]=I('<div class="threshold-info" data-v-1c3a329b><h3 data-v-1c3a329b>告警阈值说明</h3><div class="threshold-grid" data-v-1c3a329b><div class="threshold-item" data-v-1c3a329b><span class="threshold-label normal" data-v-1c3a329b>正常</span><span class="threshold-desc" data-v-1c3a329b>CPU &lt; 70%, 内存 &lt; 80%, 磁盘 &lt; 85%</span></div><div class="threshold-item" data-v-1c3a329b><span class="threshold-label warning" data-v-1c3a329b>警告</span><span class="threshold-desc" data-v-1c3a329b>CPU 70-85%, 内存 80-90%, 磁盘 85-95%</span></div><div class="threshold-item" data-v-1c3a329b><span class="threshold-label critical" data-v-1c3a329b>严重</span><span class="threshold-desc" data-v-1c3a329b>CPU &gt; 85%, 内存 &gt; 90%, 磁盘 &gt; 95%</span></div></div></div>',1))]))}},Q=C(J,[["__scopeId","data-v-1c3a329b"]]);export{Q as default};
